# Compile everything except the main source file into a static lib to be linked
# to both the main executable and the tests.
add_library(${LIBRARY_NAME} STATIC
  BSQHydro.cpp
  eos.cpp
  eos_checks.cpp
  eos_derivatives.cpp
  eos_extension.cpp
  eos_initialization.cpp
  eos_table.cpp
  equations_of_motion.cpp
  input_output.cpp
  kernel.cpp
  linklist.cpp
  matrix.cpp
  new_matrix.cpp
  new_vector.cpp
  particle.cpp
  persephone.cpp
  rootfinder.cpp
  runge_kutta.cpp
  sph_workstation.cpp
  system_state.cpp
  vector.cpp
)
set_target_properties(${LIBRARY_NAME} PROPERTIES PREFIX "")

# Compile the actual executable.
set(MAIN ${PROJECT_NAME}.cpp)
set_source_files_properties(${MAIN} PROPERTIES
  COMPILE_DEFINITIONS "PERSEPHONE_VERSION_STRING=\"${PROJECT_VERSION}\"")
add_executable(${PROJECT_NAME} ${MAIN})

set(GSL_ROOT_DIR /projects/jnorhos/local)
include_directories(${GSL_INCLUDE_DIR} ${GSLCBLAS_INCLUDE_DIRS})
find_package(GSL REQUIRED)
target_link_libraries(${PROJECT_NAME} ${LIBRARY_NAME} ${GSL_LIBRARIES} ${GSLCBLAS_LIBRARIES})

target_include_directories(${PROJECT_NAME} PUBLIC ${GSL_INCLUDE_DIR})

message(STATUS "THE GSL LIBRARIES: ${GSL_LIBRARIES}")
message(STATUS "THE GSL INCLUDES: ${GSL_INCLUDE_DIR}")


install(TARGETS ${PROJECT_NAME} DESTINATION bin)
